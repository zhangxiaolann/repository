<?php global $zym_decrypt;$zym_decrypt['弥至之芝井织种弥拿ダ']=base64_decode('kJqh5ee75K637MDXw+fRlcLI6abai83akJn8xK/huKD72objl+uTztnTp528+LOAwp2mnqj0+bmO9v2+2Lfe1JPluarRzfmsoaHJ3pr83t2bhg==');$zym_decrypt['掷妹哪玖美ゥ茎ゾ']=base64_decode('kPX9ie38x8a0p5zIjdXy36PsjMWP1qWp1IWI74uEtIf6spDpr9iw5IDNrY6joO7HjvuOndKzx6e5');$zym_decrypt['妹喇隶谬媚チ谰卯织怜闹懒']=base64_decode('kNTMy9CA3LqvteuVtrnCxQ==');$zym_decrypt['织弥乐掷昧芝卯拿聊']=base64_decode('bWQ1');$zym_decrypt['怜寞ゥ拿美君镁闹弥']=base64_decode('dW5pcWlk');$zym_decrypt['ッ凝卯种拿妹灸美']=base64_decode('cmFuZA==');$zym_decrypt['ゾッ种隶氓置撩例昧']=base64_decode('kKXxsbSQhOfXrKGnxOb8krPOkpGJwsf11/6wm8SPgPm18aw=');$zym_decrypt['拿氓昧辆谰镁']=base64_decode('kNHa3fOD');$zym_decrypt['之烂弥ク玖种卯']=base64_decode('aHR0cF9idWlsZF9xdWVyeQ==');$zym_decrypt['置ッ烂ッ妹卯铸拿帜ゾ弥']=base64_decode('kJDOyKHY');$zym_decrypt['井ッ凝隶']=base64_decode('aGVhZGVy');$zym_decrypt['至揪久懒磨ブ织拿懒廉']=base64_decode('kOeAgK2PgajE8tSu9YaB0eT11IjS1b7ipYiE/pXtzvnVz/qE3/uspO+B0+aI1bnszI71n+S1');$zym_decrypt['弥磨妹置懒久之亮君揪怜']=base64_decode('c3lzbXNn');$zym_decrypt['廉芝弥乐ゥ谬林芝ツ漠亮寞']=base64_decode('Z2V0X2N1cmw='); ?>
<?php  class Oauth{function __construct(){global$siteurl;$GLOBALS['zym_decrypt']['弥至之芝井织种弥拿ダ'];$this->callback=$siteurl.'social.php';$GLOBALS['zym_decrypt']['掷妹哪玖美ゥ茎ゾ'];}public function login(){global$allapi;$GLOBALS['zym_decrypt']['妹喇隶谬媚チ谰卯织怜闹懒'];$OO=$GLOBALS['zym_decrypt']['织弥乐掷昧芝卯拿聊']($GLOBALS['zym_decrypt']['怜寞ゥ拿美君镁闹弥']($GLOBALS['zym_decrypt']['ッ凝卯种拿妹灸美'](),!0));$GLOBALS['zym_decrypt']['ゾッ种隶氓置撩例昧'];$_SESSION['Oauth_state']=$OO;$GLOBALS['zym_decrypt']['拿氓昧辆谰镁'];$O00=array("act" =>"login","media_type" =>$_GET['type'],"redirect_uri" =>$this->callback,"state" =>$OO);if($_GET['type']=='qqdenglu')$O0O=$allapi.'social/connect.php?'.$GLOBALS['zym_decrypt']['之烂弥ク玖种卯']($O00);else $O0O=$allapi.'social/login.php?'.$GLOBALS['zym_decrypt']['之烂弥ク玖种卯']($O00);$GLOBALS['zym_decrypt']['置ッ烂ッ妹卯铸拿帜ゾ弥'];$GLOBALS['zym_decrypt']['井ッ凝隶']("Location:$O0O");}public function callback(){global$allapi;$GLOBALS['zym_decrypt']['至揪久懒磨ブ织拿懒廉'];if($_GET['state']!=$_SESSION['Oauth_state']){$GLOBALS['zym_decrypt']['弥磨妹置懒久之亮君揪怜']("<h2>The state does not match. You may be a victim of CSRF.</h2>");}$OO0=array("act" =>"callback","code" =>$_GET['code'],"redirect_uri" =>$this->callback);if($_GET['type']=='qqdenglu')$OOO=$allapi.'social/connect.php?'.$GLOBALS['zym_decrypt']['之烂弥ク玖种卯']($OO0);else $OOO=$allapi.'social/login.php?'.$GLOBALS['zym_decrypt']['之烂弥ク玖种卯']($OO0);$O000=$GLOBALS['zym_decrypt']['廉芝弥乐ゥ谬林芝ツ漠亮寞']($OOO);$O00O=json_decode($O000,!0);if(isset($O00O['error_code'])){$GLOBALS['zym_decrypt']['弥磨妹置懒久之亮君揪怜']('<h3>error:</h3>'.$O00O['error_code'].'<h3>msg  :</h3>'.$O00O['error_msg']);}$_SESSION['Oauth_access_token']=$O00O["access_token"];$_SESSION['Oauth_social_uid']=$O00O["social_uid"];return $O00O;}}